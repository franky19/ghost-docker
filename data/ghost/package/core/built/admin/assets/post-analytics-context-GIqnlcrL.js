import{r as e,u as v,aF as y,aG as D,aH as C,aI as k,j as w}from"./index-DQyPmpGB.js";import{u as I}from"./posts-C7K9oIZ5.js";const N={TODAY:{name:"Today",value:1},LAST_7_DAYS:{name:"Last 7 days",value:7},LAST_30_DAYS:{name:"Last 30 days",value:31},LAST_3_MONTHS:{name:"Last 3 months",value:91},YEAR_TO_DATE:{name:"Year to date",value:366},LAST_12_MONTHS:{name:"Last 12 months",value:372},ALL_TIME:{name:"All time",value:1e3}},G={US:"United States",TWN:"Taiwan",TW:"Taiwan",CN:"China","mobile-ios":"iOS","mobile-android":"Android",macos:"macOS","google.com":"Google","ghost.org":"Ghost","bing.com":"Bing","bsky.app":"Bluesky","yahoo.com":"Yahoo","duckduckgo.com":"DuckDuckGo"},R=["NULL","ᴺᵁᴸᴸ","","Others","Other"],c={PUBLIC:1,FREE:2,PAID:4},Y=c.PUBLIC|c.FREE|c.PAID,g=e.createContext(void 0),O=()=>{const s=e.useContext(g);if(!s)throw new Error("useGlobalData must be used within a PostAnalyticsProvider");return s},B=({children:s})=>{const{postId:a}=v();if(!a)throw new Error("Post ID is required for PostAnalyticsProvider");const o=y(),t=D(),[A,S]=e.useState(N.LAST_30_DAYS.value),d=C(),n=!!o.data?.config?.stats,i=k({enabled:n}),[m,L]=e.useState(7),{data:{posts:[T]}={posts:[]},isLoading:_}=I({searchParams:{filter:`id:${a}`,include:"email,authors,tags,tiers,count.clicks,count.signups,count.paid_conversions,count.positive_feedback,count.negative_feedback,newsletter"}}),u=[o,t,d],f=u.map(r=>r.error).find(Boolean),E=n?i.error:null,l=f||E,P=u.some(r=>r.isLoading),b=n?i.isLoading:!1,h=P||b;if(l)throw l;const p=t.data?.site?{url:t.data.site.url,icon:t.data.site.icon,title:t.data.site.title}:void 0;return w.jsx(g.Provider,{value:{data:o.data?.config,site:p,statsConfig:o.data?.config?.stats,tinybirdToken:i.token,isLoading:h,range:A,setRange:S,audience:m,setAudience:L,settings:d.data?.settings||[],postId:a,post:T,isPostLoading:_},children:s})},j=Object.freeze(Object.defineProperty({__proto__:null,default:B,useGlobalData:O},Symbol.toStringTag,{value:"Module"}));export{Y as A,N as S,R as U,c as a,G as b,j as p,O as u};
